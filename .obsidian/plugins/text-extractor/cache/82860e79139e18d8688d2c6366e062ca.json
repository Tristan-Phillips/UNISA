{"path":"Subjects/INF3707 - Database Design and Implementation/Unsorted/INF3707/INF3707 Exam pack/Exam Shit/Past Exams/INF3707-2017-10-E-1.pdf","text":"[Turn over] This paper consists of 6 pages plus an Annexure with 7 pages. INSTRUCTIONS 1. All rough work must be done in the answer book. 2. The marks for each question are given in brackets next to the question. 3. Please answer the questions in order. If you want to do a question later, leave a blank space. 4. Study the tables and data in Annexure A 5. This is not an open book examination 6. Pocket calculators are not allowed 7. Answer all questions 2 INF3707 OCT/NOV 2017 [Turn over] Section A: Multiple choice questions [20 marks]  Choose the correct answer. The marks for each question are given in brackets next to the question.  Each correct answer carries 2 marks.  Write down the question number and the letter of the correct answers or an answer (for example: 1. B) in your examination book. Question 1 1.1 If you add a row to a complex view that includes a GROUP BY clause, which of the error messages would you get. a. virtual column not allowed b. data manipulation operation not legal on this view c. cannot map to a column in a non-key-preserved table d. none of the above – no error message is returned 1.2 What does the following query do? Select isbn, title from BOOKS where (pubid, category) IN (select pubid,category from BOOKS where title like '%ORACLE%') a. It determines which publisher published a book belonging to the Oracle category and then lists all other books published by that same publisher. b. It lists all publishers and categories containing the value of ORACLE. c. It lists the ISBN and title of all books belonging to the same category and having the same publisher as any book with the phrase ORACLE in its title. d. None of the above. The query contains a multiple-row operator and because the inner query returns only one value, the SELECT statement will fail and return an error message. 1.3 Which of the following functions permits NULL values in calculations? a. SUM b. NVL c. MAX d. MIN 1.4 Which type of a join is used in the following statement? select title, order#, quantity from BOOKS full join ORDERITEMS on BOOKS.ISBN = ORDERITEMS.ISBN a. equality b. self-join c. non-equality d. outer join 1.5 Which of the following displays a list of all system privileges available in Oracle? a. SESSION_PRIVS b. SYS-PRIVILEGE_MAP c. V$SYSTEM_PRIVILEGES d. SYSTEM_PRIVILEGE_MAP 3 INF3707 OCT/NOV 2017 [Turn over] 1.6 Which of the following options allow a user to grant system privileges to other users? a. WITH ADMIN OPTION b. WITH GRANT OPTION c. DBA d. ASSIGN ROLES e. SET ROLES 1.7 Based on the structure of the CUSTOMERS table given below, which of the following is a valid SQL statement? a. CREATE PUBLIC INDEX customers_name_idx ON customers (lastname, firstname); b. CREATE BITMAP INDEX customers_name_idx FOR customers (lastname); c. CREATE INDEX customers_name_idx ON customers (lastname, firstname); d. CREATE B_TREE INDEX customers_name_idx FOR customers (lastname); 1.8 Evaluate the following SQL statement: SELECT TO_CHAR(1230,'00,999.99') FROM DUAL; What would be the outcome? a. 1,230 b. 01,230 c. 1,230.00 d. 01,230.00 1.9 If a SELECT statement has WHERE, GROUP BY and HAVING clauses, what is the order in which they are processed? a. HAVING, WHERE, GROUP BY b. WHERE, GROUP BY, HAVING c. WHERE, HAVING, GROUP BY d. GROUP BY,WHERE, HAVING 4 INF3707 OCT/NOV 2017 [Turn over] 1.10 Choose one false statement about the ORDER BY clause. a. When using the ORDER BY clause, it always appears as the last clause in a SELECT statement. b. The ORDER BY clause may appear in a SELECT statement that does not contain a WHERE clause. c. The ORDER BY clause specifies one or more terms by which the retrieved rows are sorted. These terms can only be column names. d. Positional sorting is accomplished by specifying the numeric position of a column as it appears in the SELECT list, in the ORDER BY clause. Section B [80 marks] Question 2 [20 marks] 2.1 Explain the difference between an inner join and outer join. (1 marks) 2.2 When using joins to query a database, what is the purpose of qualifiers and when are you required to use them? (2 marks) 2.3 What are the differences between the JOIN …..USING and JOIN …..ON approaches for joining tables? (2 marks) 2.4 Based on the tables of the JustLee books database, determine the profit of each book sold to Jake Lucas using the actual price paid by the customer (not the book’s regular price). Sort the results by order date. If more than one book was ordered, sort the results by profit amount in descending order. Perform the search using customer name, not the customer number. Create the query using the keywords JOIN….USING. (10 marks) 2.5 Based on the tables of the JustLee books database, display a list of all books in the BOOKS table. If the customer has ordered a book, also list the corresponding order number and identify the State in which the customer resides. Create the query using the traditional OUTER JOIN operator. (5 marks) Question 3 [15 marks] 3.1 Based on the tables of the JustLee books database, determine the amount of total profit generated by the book purchased on order 1002. Display the book title and profit. Format the profit to display a dollar sign and two decimal places. Take into account that the customer may not pay the full retail price and each item ordered can involve multiple copies. Create the query using the the TO_CHAR and join the BOOKS and the ORDERITEMS tables. (7 marks) 3.2 Based on the tables of the JustLee books database, determine the average profit generated by the orders in the ORDERS table. Calculate the total profit of the orders before finding the average profit. Create the query using group functions AVG, SUM and GROUP BY. Base your query on the BOOKS, ORDERS and ORDERITEMS tables. (8 marks) Question 4 [6 marks] Describe what the following regular expressions do. i. REGEXP_REPLACE (2 marks) ii. REGEXP_INSTR (2 marks) iii. REGEXP_SUBSTR (2 marks) 5 INF3707 OCT/NOV 2017 [Turn over] Question 5 [39 marks] 5.1 Create a table based on the following instance table. The table allows the JustLee bookstore to capture client information when buying books. Choose appropriate data types and be sure to add integrity constraints when creating the table. (10 marks) Client_Data Table Column_Name Member_ID Last_Name Address City Phone Join Date Key Type PK Not Null Null/Unique Not Null, Unique Default Value Data Type NUMBER VARCHAR2 VARCHAR2 VARCHAR2 VARCHAR2 Date Length 10 25 100 30 15 5.2 Verify that the table was created by viewing its structure. (1 mark) 5.3 Create a sequence for populating the Member_ID column of the Client _Data table. Name the sequence Client_Data_ID_Seq. Start the sequence at 101, increment the sequence by 1, have a maximum value of 5000 and do not allow caching. (5 marks) 5.4 Add the following data to the Client_Data table. Use the Client_Data_ID_Seq sequence to populate the member_id column. (5 marks) Member_id Last_name Address City Phone Join_date Brown 283 King Street Pretoria 012 429 7101 08 June 2016 5.5. Make a modification to the Client_Data table by adding the column “Next of kin”. Verify your modification. (3 marks) 5.6 Drop the Next_Of_Kin column from the Client_Data table. Confirm your modification by checking the description of the table. (3 marks) 5.7 Create a private synonym that enables you to reference Client_Data_ID_Seq object as CLIENTDET. (2 marks) 5.8 Create a B-tree index on the client’s Last_name column. Verify that the index exists by querying the data dictionary. Remove the index from data dictionary. (5 marks) 5.9 Scott is a newly appointed trainee in the database administration department. As the manager of the department, create the user Scott with a password that expire and give him access to your Client_Data table. Assign privileges to query and add rows to the table. Scott should also be able to give other users the same priviledges. (5 marks) 6 INF3707 OCT/NOV 2017 [Turn over] The end ©UNISA 2017","libVersion":"0.2.3","langs":""}