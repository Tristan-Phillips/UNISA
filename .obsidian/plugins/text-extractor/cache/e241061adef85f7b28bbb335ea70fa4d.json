{"path":"UNISA/98906 - BSc Science in Computing/INF3707 - Database Design and Implementation/Unsorted/INF3707/Examsss/Exams/2021 Jan.pdf","text":"INF3707 January/February 2021 1 Next UNIVERSITY EXAMINATIONS JANUARY / FEBRUARY 2021 INF3707 Database Design and Implementation Date: 03 February 2021 Duration: 2 hours Total marks: 100 Examiners: First: Dr B. Chipangura Second: Dr L. Motsi External: Dr P. Nkomo This is a closed book examination. Instructions to students 1. The marks for each question are given in brackets next to the question. 2. Please answer the questions in order. If you want to do a question later, leave a blank space. 3. Study the tables and data in Annexure A 4. Pocket calculators are not allowed 5. Answer all questions 6. Pledge that you have neither given nor received aid on this assignment/examination (You must respond to this pledge when submitting your assignment.) 7. After writing the exam, upload your answer sheet in PDF format on myUnisa as per instructions provided to you in Exam Tutorial letter INF3707 January/February 2021 2 Next Question 1 30 marks For this question, please choose the best answer. Write the correct answer on your answer sheet. 1.1 Which one of the SQL statements would display the value 1890.55 as $1, 890.55? (2 marks) 1. Select to_char(1890.55, ‘$9,999V99’) from dual; 2. Select to_char(1890.55,’$0G000D00’) from dual; 3. Select to_char(1890.55, ‘$99,999D99’) from dual; 4. Select to_char(1890.55, ‘$99G999V99’) from dual; 1.2 You issued the following command: DROP TABLE BOOKS; Which three statements are true? (3 marks) A. All uncommitted transactions are committed B. All indexes and constraints defined on the table being dropped are also dropped C. Sequences used in the Books table becomes invalid D. The space used by the Books table is reclaimed immediately E. The Books table can be recovered using the rollback command F. The Books table is moved to the recycle bin Choose the best combination of answers. 1. A,C,F 2. A,D,E 3. B,C,D 4. A,B,F 1.3 Evaluate the SQL statement: TRUNCATE TABLE BOOKS; Which of the following three statements are true about the SQL statement? (3 marks) A. It releases the storage space used by the table B. It does not release the storage space used by the table C. You can roll back the deletion of rows after the statement executes D. You cannot roll back the deletion of rows after the statement executes E. An attempt to use DESCRIBE on the BOOKS table after the TRUNCATE statement executes will display an error F. You must be the owner of the table or have DELETE ANY TABLE system privilege to truncate the BOOKS table. Choose the best combination of answers. 1. F, B, C 2. B, D,E 3. D, E,F 4. A, D, F INF3707 January/February 2021 3 Next 1.4 Which of the following commands eliminates only the user ELPOEZ’s ability to enter new books in the BOOKS table? (2 marks) 1. Revoke insert from elopez; 2. Revoke insert into books from elopez; 3. Revoke insert on books from elopez; 4. Drop insert into books from elopez; 1.5 Evaluate the following SQL statement: DELETE FROM order_items; If there are no other uncommitted transactions on the order_items table, which statement is true about DELETE statement? (2 marks) 1. It removes all the rows as well as the structure of the table 2. It removes all the rows in the table and the deleted rows cannot be rolled back 3. It removes all the rows in the table and the deleted rows can be rolled back 4. It would not remove the rows if the table has a primary key 1.6 Examine the data in the Orderitems tables ORDER# ITEM# QUANTITY ---------- ---------- ---------------- 1007 2 1 1007 3 1 1007 4 1 1008 1 2 1009 1 1 Evaluate the following query: select item#, avg(quantity) from orderitems having avg(quantity) > min(quantity)*0.5 group by item#; Which statement is true regarding the outcome of the above query? (2 marks) 1. It displays the item numbers with their average quantity where the average quantity is more than 0.5 the minimum quantity of that item in the table 2. It gives an error because the having clause should be specified after the GROUP BY clause 3. It gives an error because all the aggregate functions used in the HAVING clause must be specified in the SELECT list. 4. It displays the item numbers with their average quantity where the average quantity is more than 0.5 the overall quantity of the items in the table. INF3707 January/February 2021 4 Next 1.7 Consider the structure of the CUSTOMERS table. SQL> desc customers Name Type ------------------- ---------------------------- CUSTOMER# NUMBER(4) LASTNAME VARCHAR2(10) FIRSTNAME VARCHAR2(10) ADDRESS VARCHAR2(20) Which statement adds a constraint that ensures the Lastname column of the CUSTOMERS table holds a value? (2 marks) 1. Alter table customers add constraint lastname_nn check customer_name is not null; 2. Alter table customers modify lastname constraint cust_name_nn not null; 3. Alter table customers modify constraint cust_name_nn check lastname is not null; 4. Alter table customers modify last_name constraints cust_name_nn is not null; 1.8 Which of the following will display the new retail price of each book as 20 percent less than its retail price? (3 marks) 1. SELECT title, retail + 0.20 \"New Retail Price\" FROM books 2. SELECT title, retail - 0.20 \"New Retail Price\" FROM books; 3. SELECT title, retail – (0.20 *retail) \"New Retail Price\" FROM books; 4. SELECT title, retail – (retail*1.20 \"New Retail Price\" FROM books; 1.9 Which of the following commands changes a table’s name from OLDNAME to NEWNAME? (2 marks) 1. REMANE table FROM oldname TO newname 2. ALTER TABLE oldname MODIFY TO newname 3. CREATE TABLE newname (SELECT * FROM oldname) 4. RENAME oldname TO newname 1.10 The UNIQUE constraint differs from the PRIMARY KEY constraint in what way? (2 marks) 1. The UNIQUE constraint does not allow NULL values. 2. The UNIQUE constraint allows NULL values. 3. The UNIQUE constraint can be created at either the column level or the table level. 4. The UNIQUE constraint ensures that a specific condition is true before a data value is added to a table. 1.11 Where does the Oracle server store information about objects in the database, including information about constraints? (2 marks) 1. in the data reference manual 2. in the data schema 3. in the data dictionary 4. in the data view INF3707 January/February 2021 5 Next 1.12 Examine these statements: Create role sales; Grant update on customers to sales; Grant sales to user1, user2, user3; What does this set of SQL statements do? (2 marks) 1. The set of statements contain an error and does not work. 2. It creates a role called SALES, add the MODIFY privilege on the CUSTOMERS object to the role and gives the SALES role to the users 3. It creates a role called SALES, adds the UPDATE privilege on the CUSTOMERS object to the role and gives the SALES role to three users. 4. It creates a role called SALES, adds the UPDATE privilege on the CUSTOMERS object to the role and creates three users with the role. 1.13 Based on the structure of the ORDERITEMS table and the BOOK table: SQL> desc orderitems Name Null? Type -------------- -------- ---------------------------- ORDER# NOT NULL NUMBER(4) ITEM# NOT NULL NUMBER(2) ISBN VARCHAR2(10) QUANTITY NOT NULL NUMBER(3) PAIDEACH NOT NULL NUMBER(5,2) SQL> desc books Name Null? Type --------------- -------- -------------- ISBN NOT NULL VARCHAR2(10) TITLE VARCHAR2(30) PUBDATE DATE PUBID NUMBER(2) COST NUMBER(5,2) RETAIL NUMBER(5,2) DISCOUNT NUMBER(4,2) CATEGORY VARCHAR2(12) Which of the following commands will make certain that the ISBN entered in the ORDERITEMS table actually exists in the ISBN column of the BOOKS table? (3 marks) 1. ALTER TABLE orderitems ADD FOREIGN KEY isbn REFERENCES BOOKS TABLE (isbn); 2. ALTER TABLE orderitems MODIFY FOREIGN KEY (isbn) REFERENCES books(isbn); 3. ALTER TABLE orderitems CREATE FOREIGN KEY (isbn) REFERENCES books(isbn); 4. ALTER TABLE orderitems ADD FOREIGN KEY (isbn) REFERENCES books(isbn); INF3707 January/February 2021 6 Next Question 2 40 marks This question refers to the JustLee Books database, see Appendix A. Learning form the E.R diagram and the contents of the BOOKS table, the contents of the Category column are the actual names for each category of books. This structure presents a problem if one user enters COMPUTER for the Computer category and another user enters COMPUTERS. To avoid this and other problems that might occur, the database designers have decided to create a CATEGORY table containing a code (CATCODE) and description (CATDESC) for each category. The structure for CATEGORY table should be as follows: Table name: CATEGORY Column Name Datatype Width CATCODE (Primary key) VARCHAR2 3 CATDESC (Not Null) VARCHAR2 11 Here are some data entries for the CATEGORY table: CATCODE CATDESC BUS BUSINESS CHN CHILDREN COK COOKING COM COMPUTER 2.1 Create the CATEGORY table. (5 marks) 2.2 Verify that the table category was successfully created and view the schema of the table. (2 marks) 2.3 Modify the CATDESC column from the current width of 11 characters to 20 characters. (2 marks) 2.4 Populate the Category table with the given data. (8 marks) 2.5 Add a column to the BOOKS table called CATCODE. Add a FOREIGN KEY constraint that references the CATEGORY table. (6 marks) 2.6 Set the CATCODE values for the rows in the BOOKS table based on each book’s current Category value. (8 marks) 2.7 Verify that the correct categories have been assigned in the BOOKS table. (2 marks) 2.8 Delete the Category column from the BOOKS table. (2 marks) 2.9 Jabulani is a newly appointed trainee in the database administration department. As the manager of the department, create the user Jabulani, with a password that expire and give him access to the CATEGORY table. Assign him privileges to query and add rows to the table. Jabulani should also be able to give other users the same privileges. (5 marks) INF3707 January/February 2021 7 Question 3 30 marks 3.1 Use search pattern to find any book title with “A” for the second letter and “N” for the fourth letter. List each book’s ISBN and title. Sort the list by title in descending order. (4 marks) 3.2 Determine the average retail price of Books by publisher name and category. Include only the categories Children and Computer, and the groups with an average retail price greater than $50. Use the JOIN ---USING ( ) keywords. (5 marks) 3.3 Based on the tables of the JustLee books database, determine the profit of each book sold to Jake Lucas using the actual price paid by the customer (not the book’s regular price). Sort the results by order date. If more than one book was ordered, sort the results by profit amount in descending order. Perform the search using customer name, not the customer number. Create the query using the keywords (JOIN….USING). (5 marks) 3.4 Create a view that list the name and phone number of the contact person at each publisher. Do not include the publisher’s ID in the view. Name the view CONTACT. (3 marks) 3.5 Change the CONTACT view so that no users can accidentally perform DML operations on the view. (3 marks) 3.6 Determine the total profit generated by sales to customer 1017. Note: quantity should be reflected in the total profit calculation. (5 marks) 3.7 Determine which books cost less than the average cost of other books in the same category. To perform this exercise, use subqueries. (5 marks) The End © UNISA 2021","libVersion":"0.2.3","langs":""}