{"path":"Subjects/INF3707 - Database Design and Implementation/Unsorted/Assignment 3/INF3707 - Assignment 03.pdf","text":"Assignment 03 Assignment 3 Total marks Chapters covered 100 marks (100%) 3 to 13 Note that this is a COMPULSORY assignment! To do this assignment, you need access to the JustLee books database SQL code that is correct and running will be awarded full marks. Code that is logically wrong, producing wrong results or not running may not be awarded marks. Question 1: Chapters 3-5 20 marks JustLee Books would like to venture into the toy business. The diagram below shows a basic E-R model for the Toys database. The database has three tables, the Toys table, the Creator table and the ToyCreator table. The underlined columns uniquely identify each row in the associated tables. Tables description Table Name Column Data Type Length Key type TOYS ToyID Number 10 PK Name Varchar2 30 Date Date Cost Number 5,2 Retail Number 5,2 Discount Number 4,2 Category Varch2 12 TOYCREATOR ToyID Number 10 FK CreatorID Number 4 FK CREATOR CreatorID Number 4 PK LName Varchar2 10 FName Varchar2 10 1.1 Based on the information provided, write SQL statements for creating the Toys, ToyCreator and Creator tables. (6 marks) 1.2 Insert the following data into the Toys table, Creator table and the ToyCreator table. (3 marks) Toys Table toyID Name Date Cost Retail Discount Category 1001 F1 car 14-july- 2020 200 250 0 Cars Creator creatorID Lname Fname 20100714001 Jan Temba ToyCreator toyID creatorID 1001 20100714001 1.3 Display all the constraints that exists in the ToyCreator table. (2 marks) 1.4 Modify the column LName of the Creator table so that it can contain a maximum of 30 characters. Verify that the column has been changed. (3 marks) 1.5 Change the structure of the Creator table so that it can capture the address of the creator. The following columns should be used for capturing the address: house number, street, City and zip-code. (2 marks) 1.6 Mark the Discount column of the Toys table as unused. Verify that the column is unused. (2 marks) 1.7 Truncate the Creator table and then verify that the table still exist but contains no data. (2 marks) Question 2: Chapter 6 (5 marks) To do the following questions, refer to the tables in the JustLee books database. 2.1 Create a sequence for populating the Custeomer# column of the CUSTOMERS table. When setting the start and the increment values, beer in mind that the data already exist in the table. Hence, you need to know the last customer number stored in the database. The options should be set not to cycle the values and not to cache any values. No minimum or maximum values should be declared. (2 marks) 2.2 Add a new customer row by using the sequence created in Question 2.1. The only data currently available for the customer is as follows: last name = Shoulders, first_name = Frank, and zip = 23567. (3 marks) Question 3 Chapter 7 (10 marks) JustLee Books has recently hired a temporary salesman. The name of the new employee is John. The login credential for John should expire at the end of his contract. As a salesperson, John should be granted some object privileges on the JustLee Books database. 3.1 Create the user John with a password that expire with the role of sales_person (2 marks) 3.2 As a salesperson, John has full responsibility for the CUSTOMERS table of the JustLee Books and need to have object privileges to perform any activity on the customers’ table. John needs to have the right to grand the privileges to other users. (2 marks) 3.3 John approached you on a Monday morning and reported that he does not remember his password. Reset John password. (2 marks) 3.4 Write a query to view all privileges that are assigned to the Sales_person role. (2 marks) 3.5 The contract for John has expired, revoke the Sales_person privilege granted to John and remove his user account. (2 marks) Question 4: Chapter 8 (10 marks) To do the following questions, refer to tables of JustLee Books database. 4.1 Which customers live in Georgia or New Jersey? Put the results in ascending order by last name. List each customer’s customer number, last name and state. (2 marks) 4.2 List authors whose last name contains the letter pattern “IN”. Put the results in order of last name, then first name. List each author’s last name and first name. (2 marks) 4.3 Use search pattern to find any book title with “A” for the second letter and “N” for the fourth letter. List each book’s ISBN and title. Sort the list by title in descending order. (2 marks) 4.4 List the title and publish date of any computer book published in 2005. Perform the task of the searching for the publish date using a search pattern operation. (2 marks) 4.5 Examine the contents of the PUBLISHER table. PUBID NAME CONTACT PHONE ---------- -------------- --------------- - ----------- 1 PRINTING IS US TOMMIE SEYMOUR 000-714-8321 2 PUBLISH OUR WAY JANE TOMLIN 010-410-0010 3 AMERICAN PUBLISHING DAVID DAVIDSON 800-555-1211 4 READING MATERIALS INC. RENEE SMITH 800-555-9743 5 REED-N-RITE SEBASTIAN JONES 800-555-8284 Write a code that only lists the last four digits of the contact person's phone numbers at America Publishing? (2 marks) Question 5 Chapter 9 (20 marks) Refer to tables in the JustLeee Books database. 5.1 Produce a list of all customers who live in the state of Florida and have ordered books about computers. (5 marks) 5.2 Determine which books customer Jake Lucas purchased. Perform the search using the customer’s name, not the customer number. If he has purchased multiple copies of the same book, duplicate the results. Generate the report using the (JOIN…USING) keywords. (5 marks) 5.3 Which books were written by an author with the last name Adams? Perform the search using the author’s name. Generate the report using the JOIN …..USING keyword. (5 marks) 5.4 Display a list of all books in the Books table. If a book has been ordered by a customer, also list the corresponding order number and the State in which the customer resides. (5 marks) Question 6: Chapter 10 (10 marks) 6.1 Determine the total profit generated by the book purchased on order 1002. Display the book title and profit. The profit should be formatted to display a dollar sign and two decimal places. Consider that the customer might not pay the full retail price and each item ordered can involve multiple copies. (3 marks) 6.2 Display a list of all book titles and percentage of mark-up for each book. The percentage of mark-up should be displayed as a whole number (that is, multiplied by 100) with no decimal position, followed by a percent sign (for example, 0.2793 = 28%). The percentage of mark-up should reflect the difference between the retail and cost amounts as a percent of the cost. (2 marks) 6.3 Display the current day of the week, hour, minutes, and seconds of the current date setting on the computer you are using. (1 mark) 6.4 Using today’s date, determine the age (in months) of each book that JustLee sells. Make sure only whole months are displayed, ignore any portions of months. Display the book title, publication date, current date, and age. (2 marks). 6.5 Produce a list of each customer number, the third and fourth digits of his or her zip code. The query should also display the position of the first occurrence of a 3 in the customer number, if it exists. (2 marks). Question 7 Chapter 11: Subqueries (10 marks) 7.1 Explain the difference between single-row and group functions. (1 mark) 7.2 Under what circumstances must you include a GROUP BY clause in a query? (1 mark) 7.3 What’s the basic difference between the ROLLUP and CUBE extensions of the GROUP BY clause? (1 mark) 7.4 Display the number of books with retail price of more than $30.00. (2 marks) 7.5 Determine the total profit generated by sales to customer 1017. Note that quantity of books should be reflected in the profit calculation. (2 marks) 7.6 List the customers living in Georgia or Florida who have recently placed an order totaling more than $80. (3 marks) Question 8: Chapter 12 (10 marks) Refer to the JustLee books database and use subqueries to answer the following questions. 8.1 Determine which books cost less than the average cost of other books in the same category. (2 marks) 8.2 Determine which books were shipped to the same state as order 1014. (2 marks) 8.3 List the shipping city and state for the order that had the longest shipping delay. (2 marks) 8.4 Determine which customers placed orders for the least expensive book carried by the JustLee Books. (2 marks) 8.5 Determine the number of different customers who have placed an order for books written or co-authored by James Austin. (2 marks) Question 9: Chapter 13: (5 marks) Refer to the JustLee books database and answer the following queries. 9.1 Create a view that lists the name and phone number of the contact person at each publisher. Do not include the publisher’s ID in the view. Name the view Contact. (2 marks) 9.2 Change the Contact view so that no user can accidentally perform DML operations on the view. (2 marks) 9.3 Create a view called Homework 13 that includes the columns named Col1, Col2 from the FirstAtatempt table. Make sure the view is created even if the FirstAttempt table does not exist. View the structure of homework13. (1 marks) The end","libVersion":"0.2.3","langs":""}