{"path":"UNISA/98906 - BSc Science in Computing/INF3707 - Database Design and Implementation/Unsorted/INF3707/INF3707 Exam pack/Exam Shit/Past Exams/INF3707 examination.pdf","text":"[Turn over] INSTRUCTIONS to students 1. The marks for each question are given in brackets next to the question. 2. Please answer the questions in order. If you want to do a question later, leave a blank space. 3. Study the tables and data in Annexure A 4. This is not an open book examination 5. Pocket calculators are not allowed 6. Answer all questions 7. Pledge that you have neither given nor received aid on this assignment/examination (You must respond to this pledge when submitting your assignment.) 8. After writing the exam, upload your answer sheet in PDF format on myUnisa as per instructions provided to you in Exam Tutorial letter. 2 INF3707 OCT/NOV [Turn over] Question 1: [38 marks] Question 1.1 The following SQL code creates a table that keeps record of food products and checks for their expiry dates. CREATE TABLE Stock (stock_no# NUMBER (4) NOT NULL, expiry_date date CHECK (expiry_date > SYSDATE), CONSTRAINT its_pky PRIMARY KEY (stock_no#) ); When you run the code, it gives an error. (i) What causes the error? (2 marks) (ii) Briefly explain how you can correct the error (3 marks) Question 1.2 Examine the structure of the MyCustomer01 table: Create table MyCustomer01( Customer# number primary key, First_name varchar2(25), Last_name varchar2(25)) Create an SQL statement that inserts the following data into the MyCustomer01 table. The details of the customer are as follows: Customer# is 1000; First_name is Jan; Last_name is Zwane. (4 marks) Question 1.3 The Database Administrator wants to grant all users with query privileges on the MyCustomer01 table (see Question 1.2). Write an SQL statement that accomplishes this? (3 marks) Question 1.4 Write an SQL statement that would display the value 2090.55 as $2,090.55? (3 marks) Question 1.5 What does the following query do? Briefly explain. (2 marks) SELECT isbn, title FROM books WHERE (pubid, category) IN (SELECT pubid, category FROM books WHERE title LIKE %ORACLE%’); 3 INF3707 OCT/NOV [Turn over] Question 1.6 Examine the contents of the PUBLISHER table. PUBID NAME CONTACT PHONE 1 PRINTING IS US TOMMIE SEYMOUR 000-714-8321 2 PUBLISH OUR WAY JANE TOMLIN 010-410-0010 3 AMERICAN PUBLISHING DAVID DAVIDSON 800-555-1211 4 READING MATERIALS INC. RENEE SMITH 800-555-9743 5 REED-N-RITE SEBASTIAN JONES 800-555-8284 Write a query that lists only the last four digits of the contact person's phone number at Publish Our Way. (4 marks) Question 1.7 Based on the data extracted from the Books table presented in the table below, write a query that displays 5 percent of the books with the highest retail price. (4 marks) ISBN TITLE RETAIL 1059831198 BODYBUILD IN 10 MINUTES A DAY 30.95 0401140733 REVENGE OF MICKEY 22 4981341710 BUILDING A CAR WITH TOOTHPICKS 59.95 8843172113 DATABASE IMPLEMENTATION 55.95 3437212490 .....[more data] COOKING WITH MUSHROOMS ............... 19.95 ........... Question 1.8 Consider the structure of the MyCustomers02 table. Name Null? Type CUSTOMER# NOT NULL NUMBER(4) LASTNAME VARCHAR2(10) FIRSTNAME VARCHAR2(10) ADDRESS VARCHAR2(20) CITY VARCHAR2(12) STATE VARCHAR2(2) ZIP VARCHAR2(5) REFERRED NUMBER(4) REGION CHAR(2) EMAIL VARCHAR2(30) Add a constraint that ensures that the LASTNAME column of the MyCustomers02 table always requires the last name to be entered. (4 marks) 4 INF3707 OCT/NOV [Turn over] Question 1.9 Examine the structure of the ORDERS table given below. Name Null? Type ORDER# NOT NULL NUMBER(4) CUSTOMER# NUMBER(4) ORDERDATE NOT NULL DATE SHIPDATE DATE SHIPSTREET VARCHAR2(18) SHIPCITY VARCHAR2(15) SHIPSTATE VARCHAR2(2) SHIPZIP VARCHAR2(5) SHIPCOST NUMBER(4,2) Based on the ORDERS table, you want to find the value of the total shipment of all the orders for each year and you issue the following command: SELECT to_char(orderdate, 'rr'),sum(shipcost) FROM orders GROUP by to_char(orderdate,'YY'); When you execute this piece of code it gives an error. (i). What causes the error? (2 marks) (ii). Write the debugged code to correct the error. (3 marks) Question 1.10 Examine the data extracted from the CUSTOMERS table of the JustLee books database. CUSTOMER# LASTNAME REFERRED 1012 MCKENZIE 1013 NGUYEN 1006 1014 LEE 1015 SCHELL 1016 DAUM 1010 1017 NELSON 1018 MONTIASA 1019 SMITH 1003 Write a query to determine the total number of customers who were referred by other customers? (4 marks) 5 INF3707 OCT/NOV [Turn over] Question 2 36 Marks Question 2.1 Create the following table. (10 marks) Table Name: MyCustomers03 NAME NULL TYPE -------- ------ --------- myCUSTOMER# NUMBER (4) myLASTNAME NOT NULL VARCHAR2(10) myFIRSTNAME NOT NULL VARCHAR2(10) myADDRESS VARCHAR2(20) myCITY VARCHAR2(2) myZIP VARCHAR2(5) Question 2.2 The MyCustomers03 table does not have a primary key, make CUSTOMER# the primary key. (5 marks) Question 2.3 Insert data into all the columns of the MyCustomers03 table based on the data that is contained in CUSTOMERS table given below. Note that the CUSTOMERS table contain 1200 entries and you cannot insert them one by one. (6 marks) Table Name: CUSTOMERS CUSTOMER# LASTNAME FIRSTNAME ADDRESS CITY STATE ZIP REFERRED REGION 1001 MORALES BONITA BOX 651 EASTPOINT FL 32328 - SE 1002 THOMPSON RYAN BOX 9835 SANTA MONICA CA 90404 - W 1003 SMITH LEILA BOX 66 TALLAHASSEE FL 32306 - SE ... ... ... .... .... ... ... .... .... .... .... ... .... ... ..... ..... ... .... 1200 PIERSON THOMAS BOX 91 BOISE ID 83707 - NW Question 2.4 The MyCustomers03 table does not have the columns for capturing the client’s e_mail address as well as the the Province. Add the two columns to the MyCustomers03 table. (5 marks) Question 2.5 Create a bitmap index and name it my_customers_state_idx on the MyCustomers03 table to speed up queries for searching customers based on their province of residence. Verify that the index is created and then delete the index. (4 marks) Question 2.6 Create a view based on the MyCustomers03 table that lists the customer last name, first name and email. Do not include the CUSTOMER# in the view. Name the view Contact. View the contents of the view. (6 marks) 6 INF3707 OCT/NOV [Turn over] Question 3 10 Marks Examine the structure of the CUSTOMERS table extracted from the JustLee Books to answer Questions 3.1 and 3.2. SQL> desc customers; Name Null Type --------- ------- ------------ CUSTOMER# NOT NULL NUMBER(4) LASTNAME NOT NULL VARCHAR2(10) FIRSTNAME NOT NULL VARCHAR2(10) ADDRESS VARCHAR2(20) CITY VARCHAR2(12) STATE VARCHAR2(2) ZIP VARCHAR2(5) REFERRED NUMBER(4) REGION CHAR(2) EMAIL VARCHAR2(30) Question 3.1 Create a query that use right outer join to list all cities that have more than one customer along with the customer details that include CUSTOMER#, LASTNAME, AND CITY. (6 marks) Question 3.2 Use the single row functions SUBSTR and INSTR to produce a list of each customer’s number (Customer#) in the CUSTOMERS table, and the third and fourth digits of the customer’s zip code. The query should also display the position of the first occurrence of a 3 in the customer number if it exists. (4 marks) Question 4 16 Marks Question 4.1 Refer to the Books and Publisher tables of the JustLee Books database to determine the average retail price of the books by publisher name and category. Include only the categories Children and Computer, and the groups with an average retail price greater than $50. (6 marks) Question 4.2 Refer to the Books and Bookauthor tables of the JustLee Books database to determine the retail price of the least expensive book written by Sam Smith? (5 marks) Question 4.3 Suppose the management of JustLee Books wants to compare the price of each book in the inventory against the average price of all books in the inventory. Use an inline subquery to show each book’s price for prices that are above the average price of all the books. (5 marks) 7 INF3707 OCT/NOV The end ©UNISA 2020","libVersion":"0.2.3","langs":""}