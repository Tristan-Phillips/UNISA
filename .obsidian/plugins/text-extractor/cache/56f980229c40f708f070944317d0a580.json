{"path":"UNISA/98906 - BSc Science in Computing/INF3707 - Database Design and Implementation/Unsorted/Assignment 03 solution - 2022.pdf","text":"Assignment 03 solution This page has solutions for Assignments 03. We understand that in programming there is no one correct answer and our markers are aware of that. If your answer was unfairly marked, write an email to me and specify the question that you consider unfairly evaluated. Assignment 03 Memo Assignment 3 Total marks Chapter covered 100 marks (100%) 3 to 13 Note that this is a COMPULSORY assignment! To do this assignment, you need access to the JustLee books database Question 1: Chapters 3-5 JustLee Books would like to venture into the toy business. The diagram below shows a basic E-R model for the Toys database. The database has three tables, the Toys table, the Creator table and the ToyCreator table. The underlined columns uniquely identify each row in the associated tables. Tables description Table Name Column Data Type Length Key type TOYS ToyID Number 10 PK Name Varchar2 30 Date Date Cost Number 5,2 Retail Number 5,2 Discount Number 4,2 Category Varch2 12 TOYCREATOR ToyID Number 10 FK CreatorID Number 4 FK CREATOR CreatorID Number 4 PK LName Varchar2 10 FName Varchar2 10 1.1 Based on the information provided, write SQL statements for creating the Toys, ToyCreator and Creator tables If your answer is wrong somewhere, you do not deserve to get marks for the whole question. Programs should be logically correct and produce correct results. TOYS Table CREATE TABLE Toys (toyID VARCHAR2(10), name VARCHAR2(30), date DATE, Cost NUMBER (5,2), Retail NUMBER (5,2), Discount NUMBER (4,2), Category VARCHAR2(12), CONSTRAINT toys_id_pk PRIMARY KEY(toyID) ); TOYCREATOR table CREATE TABLE ToyCreator (toyID VARCHAR2(10), creatorID VARCHAR2(4), // some students may change this value to 11, this is wrong because the specification says 4 CONSTRAINT toyCreator_pk PRIMARY KEY (toyID, creatorID), CONSTRAINT ToyCreator_toyID_fk FOREIGN KEY (toyID)REFERENCES Toys (toyID), CONSTRAINT creator_id_fk FOREIGN KEY (creatorID)REFERENCES creator (creatorID) ); CREATOR Table CREATE TABLE Creator creatorID VARCHAR2(4), // // some students may change this value to 11, this is wrong because the specification says 4 Lname VARCHAR2(10), Fname VARCHAR2(10), CONSTRAINT creator_id_pk PRIMARY KEY(creatorID) ); 1.2 Insert the following data into the Toys table, Creator table and the ToyCreator table. Toys Table toyID Name Date Cost Retail Discount category 1001 F1 car 14-july- 2020 200 250 0 Cars Creator creatorID Lname Fname 20100714001 Jan Temba ToyCreator toyID creatorID 1001 20100714001 Insert into Toys (.....) values (................) Insert Into Creator (…..) values (………..); // To insert data into Table Creator, the value for column CreatorID should be changed from 4 to at least 11, so that the CreatorID value 20100714001. If you did not do that, your answer is not correct. Insert Into ToyCreator (…..) values (………..); // To insert data into Table Creator, the value of column CreatorID should be changed from 4 to at least 11. so that the CreatorID value 20100714001. If you did not do that, your answer is not correct. 1.3 Display all the constraints that exists in the ToyCreator table Select constraint_name, constraint_type, search_condition, constraint_name From user_constraints Where table_name = ‘ToyCreator’ Or Select constraints_name, column_name From user_cons_columns Where table_name = ‘ToyCreator’ 1.4 Modify the column LName of the Creator table so that it can contain a maximum of 30 characters. Verify that the column has been changed Alter table Creator Modify LName varchar2 (30) 1.5 Change the structure of the Creator table so that it can capture the address of the creator. The following columns should be used for capturing the address: house number, street, City and zip-code. ALTER TABLE Creator ADD (houseNumber varchar2(4), street varchar2(20), city varchar2(20), zipcode number (4)); 1.6 Mark the Discount column of the Toys table as used. Verify that the column no longer exists. ALTER TABLE Toys SET UNUSED (discount); SELECT * FROM Toys 1.7 Truncate the Creator table and then verify that the table still exist but contains no data. TRUNCATE TABLE Creator SELECT * FROM Creator; Question 2: Chapter 6 To perform the following assignments, refer to the tables in the JustLee books database. 2.1 Create a sequence for populating the Custeomer# column of the CUSTOMERS table. When setting the start and the increment values, beer in mind that data already exist in the table. Hence, you need to know the last customer number stored in the database. The options should be set not to cycle the values and not to cache any values. No minimum or maximum values should be declared. CREATE SEQUENCE cust_seq START WITH 1021 NOMAXVALUE NOMINVALUE NOCACHE NOCYCLE; Or CREATE SEQUENCE customers_customer#_seq START WITH 1021 NOCACHE; 2.2 Add a new customer row by using the sequence created in Question 1.1. the only data currently available for the customer is as follows: last name = Shoulders, first_name = Frank, and zip = 23567. INSERT INTO customers (customer#, lastname, firstname, zip) VALUES (cust_seq.NEXTVAL, 'SHOULDERS', 'FRANK', '23567'); Question 3 Chapter 7 JustLee Books has recently hired a temporary salesman. The name of the new employee is John. The login credential for John should expire at the end of his contract. As a salesperson, John should be granted some object privileges on the JustLee Books database. 3.1 create the user John with a password that expire with the role of sales_person CREATE USER John IDENTIFIED BY password PASSWORD EXPIRE; CREATE ROLE Sales_person; GRANT Sales_person TO John 3.2 As a salesperson, John has full responsibility for the CUSTOMERS table of the JUSTLee Books and need to have object privileges to perform any activity on the customers table. John needs to have the right to grand the privileges to other users. GRANT All ON customers TO John WITH GRANT OPTION 3.3 John approached you on a Monday morning and reported that he does not remember his password. Reset John password. ALTER USER John IDENTIFIED by password PASSWORD EXPIRE; 3.4 write a query to view all privileges that are assigned to the Sales_person role. SELECT * FROM role_tab_privs WHERE role = ‘Sales_person’ ORDER BY table_name; 3.5 The contract for John has expired, revoke the Sales_person privilege granted to John and remove his user account. /* revoke Sales_person from John */ REVOKE Sales_person FROM John /* Drop user John */ DROP USER John Question 4 Chapter 8 To do the following questions, refer to tables created in the JLDB_Build.sql script at the beginning of the chapter. Give SQL statements for the following requests. 4.1 Which customers live in Georgia or New Jersey? Put the results in ascending order by last name. List each customer’s customer number, last name and state. SELECT customer#, lastname, state FROM customers WHERE state = 'GA' or state = 'NJ' ORDER BY lastname; Or SELECT customer#, lastname, state FROM customers WHERE state IN ('GA', 'NJ') ORDER BY lastname; 4.2 List authors whose last name contains the letter pattern “IN”. Put the results in order of last name, then first name. List each author’s last name and first name. SELECT lname, fname FROM author WHERE lname LIKE '%IN%' ORDER BY lname, fname; 4.3 Use search pattern to find any book title with “A” for the second letter and “N” for the fourth letter. List each book’s ISBN and title. Sort the list by title in descending order. SELECT isbn, title FROM books WHERE title LIKE '_A_N%' ORDER BY title DESC; 4.4 List the title and publish date of any computer book published in 2005. Perform the task of the searching for the publish date using a search pattern operation. SELECT title, pubdate FROM books WHERE category = 'COMPUTER' AND pubdate LIKE '%05'; 4.5 Examine the contents of the PUBLISHER table. PUBID NAME CONTACT PHONE ---------- -------------- --------------- - ----------- 1 PRINTING IS US TOMMIE SEYMOUR 000-714-8321 2 PUBLISH OUR WAY JANE TOMLIN 010-410-0010 3 AMERICAN PUBLISHING DAVID DAVIDSON 800-555-1211 4 READING MATERIALS INC. RENEE SMITH 800-555-9743 5 REED-N-RITE SEBASTIAN JONES 800-555-8284 Write a code that only lists the last four digits of the contact person's phone numbers at America Publishing? SELECT SUBSTR(phone, -4,4) FROM publisher WHERE name = ‘AMERICAN PUBLISHING’; Question 5 Chapter 9 Refer to tables in the JustLeee Books database. 5.1 Produce a list of all customers who live in the state of Florida and have ordered books about computers. a) SELECT DISTINCT c.lastname, c.customer# FROM books b, orders o, orderitems i, customers c WHERE c.customer# = o.customer# AND o.order# = i.order# AND i.isbn = b.isbn AND c.state = 'FL' AND b.category = 'COMPUTER'; Or SELECT DISTINCT c.lastname, customer# FROM books b JOIN orderitems USING (isbn) JOIN orders USING (order#) JOIN customers c USING (customer#) WHERE c.state = 'FL' AND b.category = 'COMPUTER'; 5.2 Determine which books customer Jake Lucas purchased. Perform the search using the customer name, not the customer number. If he has purchased multiple copies of the same book, duplicate the results. Generate the report using the (JOIN…USING) keywords. SELECT b.title FROM customers c JOIN orders USING (customer#) JOIN orderitems USING (order#) JOIN books b USING (isbn) WHERE c.firstname = 'JAKE' AND c.lastname = 'LUCAS'; 5.3 Which books where written by author by author with the last name Adams? Perform the search using the author name. Generate the report using the JOIN keyword. SELECT b.title FROM books b JOIN bookauthor USING (isbn) JOIN author a USING (authorid) WHERE a.lname = 'ADAMS'; 5.4 Display a list of all books in the Books table. If a book has been ordered by a customer, also list the corresponding order number and the State in which the customer resides. SELECT b.title, o.order#, c.state FROM books b, orders o, orderitems i, customers c WHERE c.customer# (+) = o.customer# AND o.order# (+) = i.order# AND i.isbn (+) = b.isbn; Or SELECT b.title, order#, c.state FROM books b LEFT OUTER JOIN orderitems i USING (isbn) LEFT OUTER JOIN orders USING (order#) LEFT OUTER JOIN customers c USING (customer#); Question 6: Chapter 10 6.1 Determine the total profit generated by the book purchased on order 1002. Display the book title and profit. The profit should be formatted to display a dollar sign and two decimal places. Consider that the customer might not pay the full retail price and each item ordered can involve multiple copies. SELECT title, TO_CHAR(quantity*(paideach-cost), '$999.99')as Profit FROM books JOIN orderitems USING (isbn) WHERE order# = 1002; 6.2 Display a list of all book titles and percentage of mark-up for each book. The percentage of mark-up should be displayed as a whole number (that is, multiplied by 100) with no decimal position, followed by a percent sign (for example, 0.2793 = 28%). The percentage of mark-up should reflect the difference between the retail and cost amounts as a percent of the cost. SELECT title, ROUND((retail-cost)/cost *100, 0)||'%' as \"Markup %\" FROM books; 6.3 Display the current day of the week, hour, minutes, and seconds of the current date setting on the computer you are using SELECT TO_CHAR(CURRENT_DATE, 'DAY, HH:MI:SS') FROM dual; 6.4 using today’s date, determine the age (in months) of each book that JustLee sells. Make sure only whole months are displayed, ignore any portions of months. Display the book title, publication date, current date and age. SELECT title, pubdate, SYSDATE, TRUNC(MONTHS_BETWEEN(SYSDATE, pubdate),0) Age FROM books; 6.5 Produce a list of each customer number and the third and fourth digits of his or her zip code. The query should also display the position of the first occurrence of a 3 in the customer number, if it exists. SELECT customer#, SUBSTR(zip, 3, 2), INSTR(customer#, 3) FROM customers; Question 7 Chapter 11: Subqueries 7.1 Explain the difference between single-row and group functions. A single-row function returns one result for each row processed while a group function returns one result for each group of data processed. 7.2 Under what circumstances must you include a GROUP BY clause in a query? If a single column is listed in a SELECT clause along with a group function 7.3 What’s the basic difference between the ROLLUP and CUBE extensions of the GROUP BY clause? The CUBE extension performs aggregations for all possible combinations of columns, and the ROLLUP extension simply calculates cumulative subtotals for the columns. 7.4 Display the number of books with retail price of more than $30.00. SELECT COUNT(*) FROM books WHERE retail > 30; 7.5 Determine the total profit generated by sale to customer 1017. Note that quantity should be reflected in the profit calculation SELECT SUM((retail-cost)*quantity) FROM books, orders, orderitems WHERE books.isbn = orderitems.isbn AND orderitems.order# = orders.order# AND customer# = 1017; 7.6 List the customers living in Georgia or Florida who have recently placed an order totaling more than $80 SELECT DISTINCT firstname, lastname FROM customers, books, orders, orderitems WHERE customers.customer# = orders.customer# AND orders.order# = orderitems.order# AND orderitems.ISBN = books.ISBN AND (state = 'GA' OR state = 'FL') GROUP BY orders.order#, firstname, lastname HAVING SUM(retail*quantity) > 80; Question 8: Chapter 12 8.1 Determine which books cost less than the average cost of other books in the same category. Use subqueries to answer the question. SELECT a.title, b.category, a.cost FROM books a, (SELECT category, AVG (cost) averagecost FROM books GROUP BY category) b WHERE a.category = b.category AND a.cost < b.averagecost; 8.2 Determine which books were shipped to the same state as order 1014. Use subqueries to answer the question. SELECT order# FROM orders WHERE shipstate = (SELECT shipstate FROM orders WHERE order# = 1014); 8.3 List the shipping city and state for the order that had the longest shipping delay. SELECT shipcity, shipstate FROM orders WHERE shipdate-orderdate = (SELECT MAX (shipdate-orderdate) FROM orders); 8.4 Determine which customers placed orders for the least expensive book (in retails of regular retail price) carried by the JustLee Books. SELECT customer# FROM customers JOIN orders USING (customer#) JOIN orderitems USING (order#) JOIN books USING (isbn) WHERE retail = (SELECT MIN(retail) FROM books); 8.5 Determine the number of different customers who have placed an order for books written or co-authored by James Austin. SELECT COUNT (DISTINCT customer#) FROM orders JOIN orderitems USING (order#) WHERE isbn IN (SELECT isbn FROM orderitems JOIN bookauthor USING (isbn) JOIN author USING (authorid) WHERE lname = 'AUSTIN' AND fname = 'JAMES'); Question 9: Chapter 13: 9.1 Create a view that lists the name and phone number of the contact person at each publisher. Do not include the publisher’s ID in the view. Name the view Contact. CREATE VIEW contact AS SELECT contact, phone FROM publisher; 9.2 Change the Contact view so that no user can accidentally perform DML operations on the view. CREATE OR REPLACE VIEW contact AS SELECT contact, phone FROM publisher WITH READ ONLY; 9.3 Create a view called Homework 13 that includes the columns named Col1, Col2 from the FirstAtatempt table. Make sure the view is created even if the FirstAttempt table does not exist. View the structure of homework13. CREATE FORCE VIEW homework13 AS SELECT col1, col2 FROM firstattempt;","libVersion":"0.2.3","langs":""}