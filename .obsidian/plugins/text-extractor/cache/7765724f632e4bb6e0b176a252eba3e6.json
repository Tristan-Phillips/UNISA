{"path":"Subjects/INF3707 - Database Design and Implementation/Unsorted/INF3707/3707_exam_prep.pdf","text":"May 2019 Section A Question 1 [40 Marks] Which of the following is true of the SQL query given below? (Choose the best answer) (Repeats x3) 1. SELECT col1, col2 FROM tab1 WHERE col1 = ‘A’ ORDER BY col2 DESC, col1; It will display the row which has the col1 value as ‘A’ ordered by the col1 in descending order and then col2 in the descending order. a. The ORDER BY clause will not work as the keyword DESC should always be written in the end of the ORDER BY clause and not in between as given in the query. b. The above query will be sorted in descending order on the basis of col2 only and the use of col1 in the ORDER BY clause will be discarded. c. It will display the row which has the col1 value as ‘A’ ordered by the col1 and then followed by col2 as the execution of the ORDER BY clause happens from the order of the columns in the SELECT statement d. What does the following query do? (Choose the best answer) (Repeats x4)2. SELECT isbn, title FROM BOOKSWHERE (pubid, category) IN (SELECT pubid, category FROM BOOKS WHERE title like ‘%ORACLE%’) It determines which publisher published a book belonging to the Oracle category and then lists all other books published by that same publisher. a. It lists all publishers and categories containing the value of ORACLEb. It lists the ISBN and title of all books belonging to the same category and having the same publisher as any book with the phrase ORACLE in its title. c. None of the above. The query contains a multiple-row operator and because the inner query returns only one value, the SELECT statement will fail and return an error message d. Based on the structure of the CUSTOMERS table given below, which of the following is a valid SQL statement? (Choose the best answer) (Repeats x4) 3. CREATE PUBLIC INDEX customers_name_idxa. ON customers (lastname, firstname) CREATE BITMAP INDEX customers_name_idxb. FOR customers (lastname) CREATE INDEX customers_name_idxc. ON customers (lastname, firstname) CREATE B_TREE INDEX customers_name_idxd. FOR customers (lastname) Which data dictionary objects contain a column named HIDDEN_COLUMN? (Choose the best answer) (Repeats x1) USER_HIDE_COLSa. USER_TABLESb. USER_COLUMNSc. USER_TAB_COLSd. 4. Which of the following commands lock the JustLee database’ BOOKS table in EXCLUSIVE mode? (Choose the best answer) LOCK table BOOKS EXCLUSIVELYa. LOCK table BOOKS IN EXCLUSIVE MODEb. 5. 1. Repeated Questions Wednesday, 23 October 2019 15:11 INF3707 Page 1 LOCK table BOOKS IN EXCLUSIVE MODEb. LOCK table BOOKS TO OTHER USERSc. All the answers are correctd. You successfully execute the following SQL statement:6. GRANT UPDATE (Orderdate) ON OrdersTO David WITH GRANT OPTION; Which two statements are true? (Choose 2 best answers that apply) DAVID may grant this privilege to all users in the database, but he may not grant it to PUBLIC a. DAVID may grant this privilege to a role that has been granted to himb. DAVID may revoke this privilege from users who have been granted this privilege by himc. The DBA may revoke this privilege from roles that have been granted this privilege by DAVID d. Which three statements are true about roles? (Choose 3 best answers that apply) A password may be specified for a role only when the role is created.a. A role may be granted both system and object privileges.b. A role may be dropped only after it is revoked manually from all users and roles to which it has been granted. c. Multiple roles may be granted to a role.d. Multiple roles granted to a user may be enabled as default roles for that user.e. 7. Which three statements are true about indexes in Oracle Database 12c? (Choose 3 best answers that apply) There may be more than one index on a single columna. Indexes may not be always speed up data access to table datab. Multiple invisible indexes may exist on a columnc. Indexes may be created on a viewd. 8. Which of the following are valid CREATE TABLE statements? (Choose 3 best answers that apply) CREATE TABLE $ORDERSa. (ID NUMBER, NAME VARCHAR2(30)); CREATE TABLE CUSTOMER_HISTORYb. (ID NUMBER, NAME VARCHAR2(30)); CREATE TABLE “Boat Inventory”c. (ID NUMBER, NAME VARCHAR2(30)); CREATE TABLE workScheduled. (ID NUMBER, NAME VARCHAR2(30)); 9. Which of the following are Data Manipulation Language statements? (Choose 2 best answers that apply) SELECTa. GRANTb. INSERTc. DROPd. 10. Which of the following is true of the ORDER BY clause? (Choose 2 best answers that apply) It can be used in the UPDATE statement as well as SELECT and DELETEa. It can sort rows based on data that isn’t displayed as part of the SELECT statementb. If the list of ORDER BY expressions uses the “by position” form, then all expressions in the ORDER BY must use the “by position” form c. It is optionald. 11. Section B Question 2 [24 Marks] Discuss the following types of joins (8 Marks) Equality Joins Creates a join by using a commonly named and defined column. Uses the JOIN … USING keywords a. Self-Joins Joins a table to itself. Uses the JOIN … ON keywords b. Inner Joins Same as a Equality Join. Uses the WHERE clause c. Outer Joinsd. 1. 2. INF3707 Page 2 Outer Joins Includes records of a table in output when there's no matching record in the other table. Uses the JOIN method with OUTER JOIN keywords d. Based on the tables of the JustLee books database, determine the average profit generated by the orders in the ORDERS table. Calculate the total profit of the orders before finding the average profit. Create the query using group functions AVG, SUM and GROUP BY. Base your query on the BOOKS, ORDERS and ORDERITEMS tables. (10 Marks) SELECT AVG(SUM((paideach-cost)*quantity)) as \"Average Profit\" FROM orderitems JOIN books USING (isbn) JOIN orders USING (order#) GROUP BY order#; 2. Study the two pieces of code presented below, Code 1 and Code 2. Code 1 creates a database table named TEST_INDENT and Code 2 inserts data into the TEST_INDENT table. What is the output after execution Code 1 and Code 2? Explain your answer. (6 Marks) 3. Code 1 CREATE TABLE TEST_INDENT (col1 NUMBER generated as identity primary key, col2 NUMBER); Code 2 INSERT INTO TEST_INDENT (col1) VALUES (350) INSERT INTO TEST_INDENT (col1, col2) VALUES (222, 355) INSERT INTO TEST_INDENT (col1, col2) VALUES (DEFAULT, 360) Question 3 [36 Marks]3. JustLee Books would like to create some new tables to store office equipment inventory data. The diagram below shows a basic E-R model for the three tables including the needed columns and relationship lines. The underlined columns uniquely identify each row in the associated table. After analysing the data requirements, the following list of requirements were developed: Each department must be unique (Dept_ID, Number (2), CONSTRAINT, PRIMARY KEY)• Each department must be assigned a name (Dept_Name, VARCHAR2 (10))• Each equipment type must be unique (EquipType_ID, Number (2), CONSTRAINT, PRIMARY KEY)• Each equipment type must be assigned a name (Equip_Name, VARCHAR2 (10))• Each equipment item must be unique (Equip_ID, Number (5), CONSTRAINT, PRIMARY KEY)• Each equipment item must be assigned a valid department (CONSTRAINT equip_dept_id_fk FOREIGN KEY) • An equipment item be assigned an equipment type, and it must be valid (CONSTRAINT equip_type_id_fk FOREIGN KEY) • Valid rating values for equipment are A, B, and C (CONSTRAINT iquip_rating_ck)• Based on the information provided above, write SQL statements for creating the EQUIPMENT table, the table in the middle of the E-R model. (10 Marks) 1. CREATE TABLE Equipment (Equip_ID NUMBER(5), Equip_desc CHAR(20), Purchase_date DATE, Rating CHAR(1), Dept_ID NUMBER(2), EquipType_ID NUMBER(2), CONSTRAINT equip_id_pk PRIMARY KEY (Equip_ID) CONSTRAINT equip_dept_id_fk FOREIGN KEY (Dept_ID) REFERENCES Department (Dept_ID), INF3707 Page 3 REFERENCES Department (Dept_ID), CONSTRAINT equip_type_id_fk FOREIGN KEY (EquipType_ID) REFERENCES Equiptype(EquipType_ID), CONSTRAINT iquip_rating_ck CHECK (Rating IN ('A','B','C'))); Display all the constraints that exists in the EQUIPMENT table. (5 Marks) SELECT * FROM user_constraints WHERE table_name = 'EQUIPMENT'; 2. Create a sequence for populating the Equip_ID column of the EQUIPMENT table. Name the sequence Equip_Data_ID_Seq. Start the sequence at 10, increment the sequence by 2, have a maximum value of 1000 and do not allow caching. (5 Marks) CREATE SEQUENCE Equip_Data_ID_Seq INCREMENT BY 2 START WITH 10 MAXVALUE 1000 NOCACHE; 3. Add the following data to the EQUIPMENT table. Use the Equip_Data_ID_Seq sequence to populate the Equip_ID column. (5 Marks) 4. INSERT INTO Equipment (Equip_ID, Equip_Desc, Purchase_Date, Rating, Dept_ID, EquipType_ID) VALUES (Equip_Data_ID_Seq.NEXTVAL, 'Fork lift', 'OCT-21-18', 'A', 1, 1); INSERT INTO Equipment VALUES (Equip_Data_ID_Seq.NEXTVAL, 'Printer', 'JUN-05-2016', 'B', 2, 2); INSERT INTO Equipment VALUES (Equip_Data_ID_Seq.NEXTVAL, 'Fax', 'Jul-10-2015', 'B', 2, 3); INSERT INTO Equipment VALUES (Equip_Data_ID_Seq.NEXTVAL, 'Laptop', 'Jan-20-2019', 'A', 2, 4); Disable the iquip_rating_ck constraint. (2 Marks) ALTER TABLE Equipment DISABLE CONSTRAINT iquip_rating_ck; 5. Drop the primary key for the EQUIPMENT table. (2 Marks) ALTER TABLE Equipment DROP PRIMARY KEY; 6. Create a private synonym that enables you to reference Equip_Data_ID_Seq object as EQUIP_DATA. (2 Marks) CREATE SYNONYM EQUIP_DATA FOR Equip_Data_ID_Seq; 7. Create a B-tree index on the EQUIPMENT table’s Equip_desc column. Verify that the index exists by querying the data dictionary. Remove the index from data dictionary. (5 Marks) CREATE INDEX Equipment_Equip_desc_idx ON Equipment (Equip_desc); SELECT table_name, index_name, index_type FROM user_indexes WHERE table_name = 'EQUIPMENT'; DROP INDEX Equipment_desc_idx; 8. October 2018 Section A Question 1 [30 Marks] Which of the following clauses are used to suppress duplicates in a SELECT statement? Choose the best answer a. 1. 4. INF3707 Page 4 INTERSECT, DISTINCTa. DUPLICATE, INTERSECTb. UNIQUE, INTERSECTc. DISTINCT, UNIQUEd. Determine the output of the query below2. SELECT (100 - 25)/15*(20 - 3) FROM dual 85a. 0.294b. -85c. 63.67d. Which of the following statements are correct about the WHERE clause? Column Alias can be used in WHERE clause to refer a columna. Functions can be used as operands in the WHERE clauseb. Comparison operator is an optional element in WHERE clause conditionc. There can be multiple WHERE clause in a SELECT queryd. 3. Which of the following is true about the SQL query given below?4. SELECT col1, col2 FROM tab1 WHERE col1 = ‘A’ ORDER BY col2 DESC, col1; It will display the row which has the col1 value as ‘A’ ordered by the col1 in the descending order and then col2 in the descending order. a. The ORDER BY clause will not work as the keyword DESC should always be written in the end of the ORDER BY clause and not in between as given in the query. b. The above query will be sorted in descending order on the basis of col2 only and the use of col1 in the ORDER BY clause will be discarded. c. It will display the row which has the col1 value as ‘A’ ordered by the col1 and then followed by col2 as the execution of the ORDER BY clause happens from the order of the columns in the SELECT statement d. What does the following query do?5. SELECT isbn, title FROM BOOKS WHERE (pubid, category) IN (SELECT pubid, category FROM BOOKS WHERE title like ‘%ORACLE%’) It determines which publisher published a book belonging to the Oracle category and then lists all other books published by that same publisher. a. It lists all publishers and categories containing the value of ORACLEb. None of the above. The query contains a multiple-row operator and because the inner query returns only one value, the SELECT statement will fail and return an error message c. It lists the ISBN and title of all books belonging to the same category and having the same publisher as any book with the phrase ORACLE in its title. d. Refer to the table given below to answer the following questions6. Which of the following SQL statements will display the profit generated by each book stored in the BOOKS tables? SELECT title, retail, costa. FROM books b. INF3707 Page 5 SELECT title, retail – costb. FROM books SELECT pubid, cost, retailc. FROM books All of the aboved. Which type of a join I used in the following statement?7. SELECT title, order#, quantity FROM BOOKS FULL JOIN ORDERITEMS ON BOOKS.ISBN = ORDERITEMS.ISBN equalitya. self-joinb. non-equalityc. none of the aboved. Which of the following displays a list of all system privileges available in Oracle? SESSION_PRIVSa. SYS-PRIVILEGE_MAPb. V$SYSTEM_PRIVILEGESc. SYSTEM_PRIVILEGE_MAPd. 8. Which of the following options allow a user to grant system privileges to other users? WITH ADMIN OPTIONa. WITH GRANT OPTIONb. ASSIGN ROLESc. SET ROLESd. 9. Which of the following commands changes a table’s name from OLDNAME to NEWNAME? RENAME oldname TO newnamea. RENAME table FROM oldname TO newnameb. ALTER TABLE oldname MODIFY TO newnamec. CREATE TABLE newname * (SELECT * FROM oldname)d. 10. If a PRIMARY KEY constraint, named ORDERITEMS_PK, exists for the ORDER# and ITEM# columns of the ORDERITEMS table, which of the following commands will disable the constraint? ALTER TABLE orderitemsa. DISABLE PRIMARY KEY CONSTRAINT ALTER TABLE orderitemsb. DISABLE CONSTRAINT orderitems_pk; ALTER TABLE orderitemsc. REMOVE PRIMARY KEY CONSTRAINT; ALTER TABLE orderitemsd. MODIFY PRIMARY KEY CONSTRAINT DISABLE; 11. Which of the following commands is used to add data to an existing row in a table? ADDa. UPDATEb. INSERTc. MODIFYd. 12. Which of the following commands is used to create a function-based index? CREATE FUNCTION INDEX . ONa. CREATE INDEX . ONb. CREATE INDEX . FORc. CREATE INDEX ..FUNCTIONd. 13. Which command will delete a user account from a database? DELETE USER usernamea. DELETE USER username IDENTIFIED BY passwordb. DROP USER username IDENTIFIED BY passwordc. DROP USER username;d. 14. If a SELECT statement has WHERE, GROUP BY and HAVING clauses, what is the order in which they are processed? HAVING, WHERE, GROUP BYa. WHERE, GROUP BY, HAVINGb. WHERE, HAVING, GROUP BYc. GROUP BY, WHERE, HAVINGd. 15. Section B INF3707 Page 6 Section B Question 2 [30 Marks] Use search pattern to find any book title with “A” for the second letter and “N” for the fourth letter. List each book’s ISBN and title. Sort the list by title in descending order. (4 Marks) 1. Determine the average retail price of Books by publisher name and category. Include only the categories Children and Computer, and groups with an average retail price greater than $50. Use the keywords JOIN … USING. (6 Marks) 2. List the book title and retail price for all books with a retail price lower than the average retail price of all the books sold by JustLee Books. Use subqueries. (4 Marks) 3. Create a view that list the name and phone number of the contact person at each publisher. Don’t include the publisher’s ID in the view. Name the view CONTACT. (3 Marks) 4. Change the CONTACT view so that no users can accidentally perform DML operations on the view. (3 Marks) 5. Based on the tables of the JustLee books database, determine the profit of each book sold to Jake Lucas using the actual price paid by the customer (not the book’s regular price). Sort the results by order date. If more than one book was ordered, ort the results by profit amount in descending order. Perform the search using customer name, not the customer number. Create the query using the keywords JOIN … USING. (10 Marks) 6. 5. Question 3 [40 Marks]6. This question refers to Annexure A, the JustLee Books database. Learning from the E-R diagram and the contents of the BOOKS table, the contents of the Category column are the actual names for each category of books. This structure presents a problem if one user enters COMPUTER for the Computer category and another user enters COMPUTERS. To avoid this and other problems that might occur, the database designers have decided to create a CATEGORY table containing a code (CATCODE) and description (CATDESC) for each category. The structure for CATEGORY table should be as follows: Create the CATEGORY table. (3 Marks)1. The table that you have created does not have a primary key, make the column CATCODE the primary key of the table. (3 Marks) 2. The CATDESC column can accept null values, add a constraint to ensure that it does not allow null values. (2 Marks) 3. Modify the CATDESC column from the current width of 11 characters to 20 characters (2 Marks)4. Populate the Category table with the given data. Save the changes permanently. (8 Marks)5. Add a column to the BOOKS table called Catcode. Add a FOREIGN KEY constraint that requires all category codes entered in the BOOKS table to already exist in the CATEGORY table (4 Marks) 6. Set the CATCODE values for the rows in the BOOKS table based on each books current Category value (8 Marks) 7. INF3707 Page 7 value (8 Marks) Verify that the correct categories have been assigned in the BOOKS table based on each book’s current Category value (1 Marks) 8. Delete the Category column from the BOOKS table (2 Marks)9. Jabulani is a newly appointed trainee in the database administration department. As the manager of the department, create the user Jabulani, with a password that expire and give him access to the CATEGORY table. Assign him privileges to query and add rows to the table. Jabulani should also be able to give other users the same privileges. (7 Marks) 10. May 2018 Section A Question 1 [30 Marks] Which of the following clauses are used to suppress duplicates in a SELECT statement? Choose the best combination INTERSECT, DISTINCTa. DUPLICATE, INTERSECTb. DISTINCT, UNIQUEc. UNIQUE, INTERSECTd. 1. Determine the output of the query below2. SELECT (100 - 25) / 15 * (20 - 3) FROM dual 0.294a. -85b. 63.67c. 85d. Which of the following statements are correct about the WHERE clause? Column Alias can be used in WHERE clause to refer a columna. Comparison operator is an optional element in WHERE clause conditionb. Functions can be used as operands in the WHERE clausec. There can be multiple WHERE clause in a SELECT queryd. 3. Which of the following is true about the SQL query given below?4. SELECT col1, col2 FROM tab1 WHERE col1 = ‘A’ ORDER BY col2 DESC, col1; It will display the row which has the col1 value as ‘A’ ordered by the col1 in the descending order and then col2 in the descending order. a. The ORDER BY clause will not work as the keyword DESC should always be written in the end of the ORDER BY clause and not in between as given in the query. b. The above query will be sorted in descending order on the basis of col2 only and the use of col1 in the ORDER BY clause will be discarded. c. It will display the row which has the col1 value as ‘A’ ordered by the col1 and then followed by col2 as the execution of the ORDER BY clause happens from the order of the columns in the SELECT statement d. What does the following query do?5. SELECT isbn, title FROM BOOKS WHERE (pubid, category) IN (SELECT pubid, category FROM BOOKS WHERE title like ‘%ORACLE%’) It determines which publisher published a book belonging to the Oracle category and then lists all other books published by that same publisher. a. It lists all publishers and categories containing the value of ORACLEb. It lists the ISBN and title of all books belonging to the same category and having the same publisher as any book with the phrase ORACLE in its title. c. None of the above. The query contains a multiple-row operator and because the inner query returns only one value, the SELECT statement will fail and return an error message d. Refer to the table given below to answer the following questions6. 7. INF3707 Page 8 Which of the following SQL statements will display the profit generated by each book stored in the BOOKS tables? SELECT title, retail, costa. FROM books SELECT title, retail – costb. FROM books SELECT pubid, cost, retailc. FROM books All of the aboved. Which type of a join I used in the following statement?7. SELECT title, order#, quantity FROM BOOKS FULL JOIN ORDERITEMS ON BOOKS.ISBN = ORDERITEMS.ISBN equalitya. self-joinb. non-equalityc. outer joind. Which of the following displays a list of all system privileges available in Oracle? SESSION_PRIVSa. SYS-PRIVILEGE_MAPb. V$SYSTEM_PRIVILEGESc. SYSTEM_PRIVILEGE_MAPd. 8. Which of the following options allow a user to grant system privileges to other users? WITH ADMIN OPTIONa. WITH GRANT OPTIONb. DBAc. ASSIGN ROLESd. SET ROLESe. 9. Based on the structure of the CUSTOMERS table given below, which of the following is a valid SQL statement? 10. CREATE PUBLIC INDEX customers_name_idxa. ON customers (lastname, firstname); CREATE BITMAP INDEX customers_name_idxb. FOR customers (lastname); CREATE INDEX customers_name_idxc. ON customers (lastname, firstname); CREATE B_TREE INDEX customers_name_idxd. FOR customers (lastname); If a SELECT statement has WHERE, GROUP BY and HAVING clauses, what is the order in which they are processed? HAVING, WHERE, GROUP BYa. WHERE, GROUP BY, HAVINGb. WHERE, HAVING, GROUP BYc. 11. INF3707 Page 9 WHERE, HAVING, GROUP BYc. GROUP BY, WHERE, HAVINGd. Which keywords are used to complete the deletion of a column previously marked with SET UNUSED? DELETE UNUSED COLUMNSa. DROP UNUSED COLUMNSb. UNSET UNUSED COLUMNSc. DROP SET COLUMNSd. 12. Which data dictionary objects contain a column named HIDDEN_COLUMN? USER_HIDE_COLSa. USER_TABLESb. USER_COLUMNSc. USER_TAB_COLSd. 13. If a PRIMARY KEY constraint, named ORDERITEMS_PK, exists for the ORDER# and ITEM# columns of the ORDERITEMS table, which of the following commands will disable the constraint? ALTER TABLE orderitemsa. DISABLE PRIMARY KEY CONSTRAINT ALTER TABLE orderitemsb. DISABLE CONSTRAINT orderitems_pk ALTER TABLE orderitemsc. REMOVE PRIMARY KEY CONSTRAINT ALTER TABLE orderitemsd. MODIFY PRIMARY KEY CONSTRAINT DISABLE 14. Sequence numbers are primarily used to generate which one of the following values? foreign keysa. indexesb. primary keysc. synonymsd. 15. Section B Question 2 [30 Marks] When using joins to query a database, what is the purpose of qualifiers and when are you required to use them? (3 Marks) When multiple tables have a common column name, the column must be prefixed with the table name, e.g. tablename.columnname. That is a column qualifier, it shows the table containing the column being referenced. 1. What are the differences between the JOIN … USING and JOIN … ON approaches for joining tables? (2 Marks) JOIN...USING joins tables based on the specified common columns, which must have the same name; JOIN...ON joins tables based on a stated condition. The JOIN...ON approach must be used if the common columns have different names. 2. Based on the tables of the JustLee books database, determine the profit of each book sold to Jake Lucas using the actual price paid by the customer (not the book’s regular price). Sort the results by order date. If more than one book was ordered, sort the results by profit amount in descending order. Perform the search using customer name, not the customer number. Create the query using the keywords JOIN … USING (10 Marks) SELECT orderdate, title, paideach-cost AS profit FROM customers c JOIN orders USING(customer#) JOIN orderitems USING(order#) JOIN books USING(isbn) WHERE c.firstname = 'JAKE' AND c.lastname = 'LUCAS' ORDER BY orderdate, profit DESC; 3. Based on the tables of the JustLee books database, display a list of all books in the BOOKS table. If the customer has ordered a book, also list the corresponding order number and identify the State in which the customer resides. Create the query using the traditional OUTER JOIN operator. (5 Marks) SELECT b.title, o.order#, c.state FROM books b, orderitems oi, orders o, customers c WHERE b.isbn = oi.isbn(+) AND oi.order# = o.order#(+) AND o.customer# = c.customer#(+); 4. Based on the tables of the JustLee books database, determine the average profit generated by the orders in the ORDERS table. Calculate the total profit of the orders before finding the average 5. 8. INF3707 Page 10 the orders in the ORDERS table. Calculate the total profit of the orders before finding the average profit. Create the query using group functions AVG, SUM and GROUP BY. Base your query on the BOOKS, ORDERS and ORDERITEMS tables (10 Marks) SELECT AVG(SUM((paideach-cost)*quantity)) as \"Average Profit\" FROM orderitems JOIN books USING (isbn) JOIN orders USING (order#) GROUP BY order#; 5. Question 3 [40 Marks] Create a table based on the following instance table. The table allows the JustLee bookstore to capture client information when buying books. Choose appropriate data types. (10 Marks) 1. CREATE TABLE client_data( member_id NUMBER(10), last_name VARCHAR2(25), address VARCHAR2(100), city VARCHAR2(30), phone# VARCHAR2(10), join_date DATE ); The table that you have created does not have a primary key, make the column Member_ID the primary key of the table (3 Marks) ALTER TABLE client_data ADD CONSTRAINT client_data_member_id_pk PRIMARY KEY (member_id); 2. The column Phone# can accept null values, add a constraint to ensure that it does not allow null values (3 Marks) ALTER TABLE client_data MODIFY (phone# NOT NULL); 3. Modify the Phone# column from the current length of 10 numbers to 13 numbers (2 Marks) ALTER TABLE client_data MODIFY (phone# NUMBER(13)); 4. Scott is a newly appointed trainee in the database administration department. As the manager of the department, give him access to your Client_Data table. Assign privileges to query and add rows to the table. Scott should also be able to give other users the same priviledges. (4 Marks) GRANT SELECT, INSERT ON client_data TO Scott WITH GRANT OPTION; 5. Create a sequence for populating the Member_ID column of the Client _Data table. Name the sequence Client_Data_ID_Seq. Start the sequence at 101, increment the sequence by 1, have a maximum value of 5000 and do not allow caching. (5 Marks) CREATE SEQUENCE client_data_id_seq 6. INCREMENT BY 1 START WITH 101 MAXVALUE 5000 NOCACHE; Add the following data to the Client_Data table. Use the Client_Data_ID_Seq sequence to populate the Member_ID column. (5 Marks) 7. INSERT INTO client_data (member_id, last_name, address, city, phone#, join_date) VALUES (client_data_id_seq.NEXTVAL, 'Brown', '283 King Street', 'Pretoria', '0124297101', '08-JUN-2016'); Make a modification to the Client_Data table by adding the column Next_Of_Kin. (2 Marks) ALTER TABLE client_data ADD (next_of_kin VARCHAR2(30)); 8. Drop the Next_Of_Kin column from the Client_Data table. (2 Marks) ALTER TABLE client_data DROP COLUMN next_of_kin; 9. Create a private synonym that enables you to reference Client_Data_ID_Seq object as CLIENTDET. (2 Marks) CREATE SYNONYM CLIENTDET FOR client_data_id_seq; 10. 11. 9. INF3707 Page 11 Create a B-tree index on the client’s Last_Name column. Verify that the index exists by querying the data dictionary. Remove the index from data dictionary. (5 Marks) CREATE INDEX clientdata_lastname_idx ON client_data(last_name); 11. SELECT table_name, index_name, index_type FROM user_indexes WHERE table_name = 'CLIENT_DATA'; DROP INDEX clientdata_lastname_idx; October 2017 Section A Question 1 [20 Marks] If you add a row to a complex view that includes a GROUP BY clause, which of the error messages would you get? virtual column not alloweda. data manipulation operation not legal on this viewb. cannot map to a column in a non-key-preserved tablec. none of the above – no error message is returnedd. 1. What does the following query do?2. SELECT isbn, title FROM BOOKS WHERE (pubid, category) IN (SELECT pubid, category FROM BOOKS WHERE title like ‘%ORACLE%’) It determines which publisher published a book belonging to the Oracle category and then lists all other books published by that same publisher. a. It lists all publishers and categories containing the value of ORACLEb. It lists the ISBN and title of all books belonging to the same category and having the same publisher as any book with the phrase ORACLE in its title. c. None of the above. The query contains a multiple-row operator and because the inner query returns only one value, the SELECT statement will fail and return an error message d. Which of the following functions permits NULL values in calculations? SUMa. NVLb. MAXc. MINd. 3. Which type of a join I used in the following statement?4. SELECT title, order#, quantity FROM BOOKS FULL JOIN ORDERITEMS ON BOOKS.ISBN = ORDERITEMS.ISBN equalitya. self-joinb. non-equalityc. outer joind. Which of the following displays a list of all system privileges available in Oracle? SESSION_PRIVSa. SYS-PRIVILEGE_MAPb. V$SYSTEM_PRIVILEGESc. SYSTEM_PRIVILEGE_MAPd. 5. Which of the following options allow a user to grant system privileges to other users? WITH ADMIN OPTIONa. WITH GRANT OPTIONb. DBAc. ASSIGN ROLESd. SET ROLESe. 6. Based on the structure of the CUSTOMERS table given below, which of the following is a valid SQL statement? 7. 10. INF3707 Page 12 CREATE PUBLIC INDEX customers_name_idxa. ON customers (lastname, firstname); CREATE BITMAP INDEX customers_name_idxb. FOR customers (lastname); CREATE INDEX customers_name_idxc. ON customers (lastname, firstname); CREATE B_TREE INDEX customers_name_idxd. FOR customers (lastname); Evaluate the following SQL statement:8. SELECT TO_CHAR(1230,'00,999.99') FROM DUAL; What would be the outcome? 1,230a. 01,230b. 1,230.00c. 01,230.00d. If a SELECT statement has WHERE, GROUP BY and HAVING clauses, what is the order in which they are processed? HAVING, WHERE, GROUP BYa. WHERE, GROUP BY, HAVINGb. WHERE, HAVING, GROUP BYc. GROUP BY, WHERE, HAVINGd. 9. Choose one false statement about the ORDER BY clause. When using the ORDER BY clause, it always appears as the last clause in a SELECT statement. a. The ORDER BY clause may appear in a SELECT statement that does not contain a WHERE clause. b. The ORDER BY clause specifies one or more terms by which the retrieved rows are sorted. These terms can only be column names. c. Positional sorting is accomplished by specifying the numeric position of a column as it appears in the SELECT list, in the ORDER BY clause. d. 10. Section B Question 2 [20 Marks] Explain the difference between an inner join and outer join. (1 Mark) The results of an innerjoin display only rows that have matches in join operations; outer joins include rows that don’t have matches in the join operations. 1. When using joins to query a database, what is the purpose of qualifiers and when are you required to use them? (2 Marks) When multiple tables have a common column name, the column must be prefixed with the table name, e.g. tablename.columnname. That is a column qualifier, it shows the table containing the column being referenced. 2. What are the differences between the JOIN …..USING and JOIN …..ON approaches for joining tables? (2 Marks) JOIN...USING joins tables based on the specified common columns, which must have the same name; JOIN...ON joins tables based on a stated condition. The JOIN...ON approach must be used if the common columns have different names. 3. Based on the tables of the JustLee books database, determine the profit of each book sold to Jake Lucas using the actual price paid by the customer (not the book’s regular price). Sort the results by order date. If more than one book was ordered, sort the results by profit amount in descending order. Perform the search using customer name, not the customer number. Create the query using the keywords JOIN….USING. (10 Marks) SELECT orderdate, title, paideach-cost AS profit 4. FROM customers c JOIN orders USING(customer#) 11. INF3707 Page 13 JOIN orders USING(customer#) JOIN orderitems USING(order#) JOIN books USING(isbn) WHERE c.firstname = 'JAKE' AND c.lastname = 'LUCAS' ORDER BY orderdate, profit DESC; Based on the tables of the JustLee books database, display a list of all books in the BOOKS table. If the customer has ordered a book, also list the corresponding order number and identify the State in which the customer resides. Create the query using the traditional OUTER JOIN operator. (5 Marks) SELECT b.title, o.order#, c.state 5. FROM books b, orderitems oi, orders o, customers c WHERE b.isbn = oi.isbn(+) AND oi.order# = o.order#(+) AND o.customer# = c.customer#(+); Question 3 [15 Marks] Based on the tables of the JustLee books database, determine the amount of total profit generated by the book purchased on order 1002. Display the book title and profit. Format the profit to display a dollar sign and two decimal places. Take into account that the customer may not pay the full retail price and each item ordered can involve multiple copies. Create the query using the the TO_CHAR and join the BOOKS and the ORDERITEMS tables. (7 Marks) SELECT title, TO_CHAR((paideach-cost)*quantity, '$999.99') AS totalprofit 1. FROM books b JOIN orderitems oi ON b.isbn = oi.isbn WHERE order# = 1002; Based on the tables of the JustLee books database, determine the average profit generated by the orders in the ORDERS table. Calculate the total profit of the orders before finding the average profit. Create the query using group functions AVG, SUM and GROUP BY. Base your query on the BOOKS, ORDERS and ORDERITEMS tables. (8 Marks) SELECT AVG(SUM((paideach-cost)*quantity)) as \"Average Profit\" 2. FROM orderitems JOIN books USING (isbn) JOIN orders USING (order#) GROUP BY order#; 12. Question 4 [6 Marks] Describe what the following regular expressions do. REGEXP_REPLACE (2 Marks) REGEXP_REPLACE lets you search a string for a regular expression pattern and replace with a provided value/expression. a. REGEXP_INSTR (2 Marks) REGEXP_INSTR lets you search a string for a regular expression pattern. It returns an integer indicating the beginning or ending position of the matched substring. b. REGEXP_SUBSTR (2 Marks) REGEXP_SUBSTR is similar to REGEXP_INSTR, but instead of returning the position of the substring, it returns the substring itself. c. 1. 13. Question 5 [39 Marks] Create a table based on the following instance table. The table allows the JustLee bookstore to capture client information when buying books. Choose appropriate data types and be sure to add integrity constraints when creating the table. (10 Marks) 1. Client_Data Table CREATE TABLE client_data( 14. INF3707 Page 14 CREATE TABLE client_data( member_id NUMBER(10), last_name VARCHAR2(25) NOT NULL, address VARCHAR2(100), city VARCHAR2(30), phone# VARCHAR2(10), join_date DATE, CONSTRAINT client_data_member_id_pk PRIMARY KEY (member_id) ); A PRIMARY KEY enforces both NOT NULL and UNIQUE constraints Verify that the table was created by viewing its structure. (1 Marks) DESC client_data; 2. Create a sequence for populating the Member_ID column of the Client _Data table. Name the sequence Client_Data_ID_Seq. Start the sequence at 101, increment the sequence by 1, have a maximum value of 5000 and do not allow caching. (5 Marks) 3. Add the following data to the Client_Data table. Use the Client_Data_ID_Seq sequence to populate the Member_ID column. (5 Marks) 4. Make a modification to the Client_Data table by adding the column Next_Of_Kin. Verify your modification. (3 Marks) 5. Drop the Next_Of_Kin column from the Client_Data table. Confirm your modification by checking the description of the table. (3 Marks) 6. Create a private synonym that enables you to reference Client_Data_ID_Seq object as CLIENTDET. (2 Marks) 7. Create a B-tree index on the client’s Last_Name column. Verify that the index exists by querying the data dictionary. Remove the index from data dictionary. (5 Marks) 8. Scott is a newly appointed trainee in the database administration department. As the manager of the department, create the user Scott with a password that expire and give him access to your Client_Data table. Assign privileges to query and add rows to the table. Scott should also be able to give other users the same privileges. (5 Marks) 9. May 2017 Section A Question 1 [40 Marks] Study this view creation statement1. CREATE VIEW dept30 AS SELECT department_id, employee_id, last_name FROM employees WHERE department_id = 30 WITH CHECK OPTION; What might make the following statement fail? (Choose the best answer) UPDATE dept30 SET department_id = 10 WHERE employee_id = 114; Unless specified otherwise, views will be created as WITH READ ONLYa. The view is too complex to allow DML operationsb. The WITH CHECK OPTION will reject any statement that changes the DEPARTMENT_ID c. The statement will succeedd. Consider these three statements2. CREATE SYNONYM S1 for EMPLOYEES; CREATE PUBLIC SYNONYM S1 for DEPARTMENTS; SELECT * FROM S1; Which of the following statements is correct? (Choose the best answer) The second statement will fail because an object S1 already existsa. The third statement will show the contents of EMPLOYEESb. The third statement will show the contents of DEPARTMENTSc. The third statement will show the contents of the table S1, if such a table exists in the current schema d. How can you change the primary key value of a row? (Choose the best answer) You cannot change the primary key valuea. 3. 15. INF3707 Page 15 You cannot change the primary key valuea. Change it with a simple UPDATE statementb. The row must be removed with a DELETE and re-entered with an INSERTc. This is only possible if the row is first locked with a SELECT FOR UPDATEd. Which join is performed by the following query? (Choose the best answer)4. SELECT E.JOB_ID, J.JOB_ID FROM EMPLOYEES E JOIN JOBS J ON (E.SALARY < J.MAX_SALARY); Equijoina. Nonequijoinb. Cross Joinc. Outer Joind. Which values are returned after executing the following statement?5. SELECT COUNT(*), COUNT(SALARY) FROM employees; Assume there are 10 employee records and each contains a SALARY value of 100, except for 1 which has a null value in their salary field. (Choose the best answer) 10 and 10a. 10 and NULLb. 10 and 9c. None of the aboved. Evaluate the following SQL statement1. SELECT TO_CHAR(1230, ‘00, 999.99’) FROM dual; What is the output for executing this statement? (Choose the best answer) 1.230a. 01,230b. 1,230.00c. 01,230.00d. Which statement is true regarding single-row functions? (Choose the best answer) They cannot be nesteda. They can accept only one argumentb. They act on each row returned and return only one result per rowc. They act on each row returned and can return multiple results per rowd. 2. Your database server is in Beijing, China. You are supporting an application with user sessions originating out of Beijing and Atlanta. You wish to ensure that your application stores dates in such a way that if your Beijing team stores date time data, such as “9 PM Beijing” your Atlanta users will see “9 PM Beijing” instead of the equivalent time in Atlanta. Which datatype is the best choice? (Choose the best answer) TIMESTAMPa. TIMESTAMP WITH TIME ZONEb. TIMESTAMP WITH LOCAL TIME ZONEc. It cannot be doned. 3. If you add a row to a complex view that includes a GROUP BY clause, which of the error messages would you get? (Choose the best answer) virtual column not alloweda. data manipulation operation not legal on this viewb. cannot map to a column in a non-key-preserved tablec. none of the above - no error message is returnedd. 4. Which of the following functions permits NULL values in calculations? (Choose the best answer) SUMa. NVLb. MAXc. MINd. 5. Which type of a join is used in the following statement? (Choose the best answer)6. SELECT title, order#, quantity FROM BOOKS FULL JOIN ORDERITEMS ON BOOKS.ISBN = ORDERITEMS.ISBN equalitya. self-joinb. non-equalityc. outer joind. INF3707 Page 16 outer joind. Which of the following displays a list of all system privileges available in Oracle? (Choose the best answer) SESSION_PRIVSa. SYS-PRIVILEGE_MAPb. V$SYSTEM_PRIVILEGESc. SYSTEM_PRIVILEGE_MAPd. 7. Which of the following options allow a user to grant system privileges to other users? (Choose the best answer) WITH ADMIN OPTIONa. WITH GRANT OPTIONb. DBAc. ASSIGN ROLESd. SET ROLESe. 8. Based on the structure of the CUSTOMERS table given below, which of the following is a valid SQL statement? (Choose the best answer) 9. CREATE PUBLIC INDEX customers_name_idxa. ON customers (lastname, firstname); CREATE BITMAP INDEX customers_name_idxb. FOR customers (lastname); CREATE INDEX customers_name_idxc. ON customers (lastname, firstname); CREATE B_TREE INDEX customers_name_idxd. FOR customers (lastname); Evaluate the following SQL statement10. SELECT TO_CHAR(1230, ‘00, 999.99’) FROM dual; What is the output for executing this statement? (Choose the best answer) 1,230a. 01,230b. 1,230.00c. 01,230.00d. If a SELECT statement has WHERE, GROUP BY and HAVING clauses, what is the order in which they are processed? HAVING, WHERE, GROUP BYa. WHERE, GROUP BY, HAVINGb. WHERE, HAVING, GROUP BYc. GROUP BY, WHERE, HAVINGd. 11. Which of the following is true of the ORDER BY clause? (Choose 2 best answers that apply) When using the ORDER BY clause, it always appears as the last clause in a SELECT statement a. The ORDER BY clause may appear in a SELECT statement that does not contain a WHERE clause b. The ORDER BY clause specifies one or more terms by which the retrieved rows are sorted. These terms can only be column names c. Positional sorting is accomplished by specifying the numeric position of a column as it appears in the SELECT list, in the ORDER BY clause d. 12. Which of the following symbols represents concatenation? (Choose the best answer) *a. ||b. []c. ‘’d. 13. Which of the following terms refers to commands that are used to create or modify database tables? (Choose the best answer) Data Manipulation Language (DML)a. 14. INF3707 Page 17 Data Manipulation Language (DML)a. Data Control Language (DCL)b. Data Definition Language (DDL)c. Data Formatting Language (DFL)d. Which command instructs Oracle to create a new table from an existing table? (Choose the best answer) CREATE NEW TABLEa. CREATE TABLE … FROMb. CREATE TABLEc. CREATE TABLE … ASd. 15. Section B Question 2 [14 Marks] Determine the structure of the Employees table (2 Marks) DESC employeesa. 1. The Human Resources department wants a query that displays the last name, job code, hire date, and employee number for each employee, with employee number appearing first. The Human Resources department wants more descriptive column headings for its report. Name the columns headings Emp#, Employee, Job and Hire Date respectively (4 Marks) SELECT employee_id AS \"Emp#\", last_name AS \"Employee\", job_id AS \"Job\", hire_date AS \"Hire Date\" a. FROM employees ORDER BY employee_id; 2. Display the last name, job and salary for all employees whose jobs are either sales representative or stock clerk and whose salaries are not equal to $2 500, $3 500, or $7 000 (5 Marks) SELECT last_name, job_id, salarya. FROM employees WHERE job_id IN ('SA_REP', 'ST_CLERK') AND salary NOT IN (2500, 3500, 7000); 3. The HR department needs to find the job titles in departments 10 and 20. Create a report to display distinct job IDs for those departments (3 Marks) SELECT DISTINCT department_id, job_ida. FROM employees WHERE department_id IN (10,20); 4. 16. Question 3 [22 Marks] The Human Resources department wants to find the length of employment for each employee. For each employee, display the last name and calculate the number of months between today and the date on which the employee was hired. Label the column MONTHS_WORKED. Order your results by the number of months employed. Round the number of months to the closet whole number. (4 Marks) SELECT last_name, ROUND(MONTHS_BETWEEN(CURRENT_DATE, hire_date), 0) AS months_worked a. FROM employees ORDER BY months_worked; 1. Create a report that displays all employees and indicate with the words Yes or No whether they receive a commission. Use the DECODE expression in your query. (4 Marks) SELECT first_name, last_name, DECODE (commission_pct, NULL, 'No', 'Yes') AS \"Receive Commission\" a. FROM employees; 2. The HR department needs to find the names and hire dates for all employees who were hired before their managers, along with their managers’ names and hire dates. Study the employees table and use self joins to answer this question. (7 Marks) SELECT e.first_name, e.last_name, e.hire_date, m.first_name AS mgr_first_name, m.last_name AS mgr_last_name, m.hire_date AS mgr_hire_date a. FROM employees e, employees m WHERE e.manager_id = m.employee_id AND e.hire_date < m.hire_date; 3. Show all employees who were hired in the first half of the month (before the 16th of the month) (2 Marks) 4. 17. INF3707 Page 18 (2 Marks) SELECT *a. FROM employees WHERE TO_NUMBER(TO_CHAR(hire_date, 'DD')) < 16; 4. Write a query that displays the employee number and last name of all employees who work in a department with any employee whose last name contains a letter u. Study the employees table and use subqueries to answer this question. (5 Marks) SELECT a.employee_id, a.last_namea. FROM employees a, ( SELECT department_id FROM employees WHERE last_name LIKE '%u%') u WHERE a.department_id = u.department_id; 5. Question 4 [13 Marks] Create the EMPLOYEES_3 table based on the structure of the EMPLOYEES table. Include only the employees_id, first name and last name. (3 Marks) CREATE TABLE employees_3 AS (a. SELECT employee_id, first_name, last_name FROM employees ); 1. Delete all the data from the new table that you have just created, if there is any (2 Marks) TRUNCATE TABLE employees_3;a. 2. Provide the SQL to create a sequence EMP_SEQ_01. The sequence should start at 2010 and have a maximum value of 2999. Have your sequence increment by 2. (4 Marks) CREATE SEQUENCE emp_seq_01a. INCREMENT BY 2 START WITH 2010 MAXVALUE 2999; 3. Provide the SQL to dynamically insert values into the EMPLOYEES_3 table. Remember to use the sequence you have created in the previous question. (4 Marks) INSERT INTO employees_3(employee_id, first_name, last_name)a. VALUES (emp_seq_01.NEXTVAL, '&FirstName', '&LastName'); 4. 18. Question 5 [11 Marks]19. Study the above table, EMPDATA, and answer the following questions Provide the SQL that will alter the table EMPDATA and add a PRIMARY KEY on the ID column. Verify your modification (5 Marks) ALTER TABLE empdata a. ADD CONSTRAINT empdata_id_pk PRIMARY KEY (id); DESC empdata; 1. Provide the SQL that will display the object names and types from the USER_OBJECTS data dictionary view for the EMPLOYEES and EMPDATA tables (4 Marks) SELECT object_name, object_typea. 2. INF3707 Page 19 SELECT object_name, object_typea. FROM user_objects WHERE object_name IN ('EMPLOYEES', 'EMPDATA'); Provide the SQL that will drop EMPDATA in such a way that it cannot be restored (2 Marks) DROP TABLE empdata PURGE;a. 3. Question 6 [20 Marks] Based on the tables of the JustLee books database, display a list of all books in the BOOKS table. If the customer has ordered a book, also list the corresponding order number and identify the State in which the customer resides. Create the query using the traditional OUTER JOIN operator. (5 Marks) 1. Based on the tables of the JustLee books database, determine the amount of total profit generated by the book purchased on order 1002. Display the book title and profit. Format the profit to display a dollar sign and two decimal places. Take into account that the customer may not pay the full retail price and each item ordered can involve multiple copies. Create the query using the TO_CHAR and join the BOOKS and the ORDERITEMS tables. (7 Marks) 2. Based on the tables of the JustLee books database, determine the average profit generated by the orders in the ORDERS table. Calculate the total profit of the orders before finding the average profit. Create the query using group functions AVG, SUM and GROUP BY. Base your query on the BOOKS, ORDERS and ORDERITEMS tables. (8 Marks) 3. 20. Question 7 [40 Marks] Create a table based on the following instance table. The table allows the JustLee bookstore to capture client information when buying books. Choose appropriate data types and be sure to add integrity constraints when creating the table. (10 Marks) 1. Client_Data Table Verify that the table was created by viewing its structure. (2 Marks)2. Create a sequence for populating the Member_ID column of the Client _Data table. Name the sequence Client_Data_ID_Seq. Start the sequence at 101, increment the sequence by 1, have a maximum value of 5000 and do not allow caching. (5 Marks) 3. Add the following data to the Client_Data table. Use the Client_Data_ID_Seq sequence to populate the Member_ID column. (5 Marks) 4. Make a modification to the Client_Data table by adding the column Next_Of_Kin. Verify your modification. (3 Marks) 5. Drop the Next_Of_Kin column from the Client_Data table. Confirm your modification by checking the description of the table. (3 Marks) 6. Create a private synonym that enables you to reference Client_Data_ID_Seq object as CLIENTDET. (2 Marks) 7. Create a B-tree index on the client’s Last_Name column. Verify that the index exists by querying the data dictionary. Remove the index from data dictionary. (5 Marks) 8. Scott is a newly appointed trainee in the database administration department. As the manager of the department, create the user Scott with a password that expire and give him access to your Client_Data table. Assign privileges to query and add rows to the table. Scott should also be able to give other users the same privileges. (5 Marks) 9. 21. INF3707 Page 20 INF3707 Page 21","libVersion":"0.2.3","langs":""}